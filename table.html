<!DOCTYPE html>
<html>

<head>
  <title>Live Monitoring Of Water</title>

  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Linking custom css sheet -->
  <link rel="stylesheet" href="main.css" type="text/css">
</head>

<body background="back.jpg">
  <div class="div1" style="border-style: ridge" >
    <h1 style="color:red; text-align:center;"> FLOOD MONITORING</h1>
  </div>
  <div class="navbar">
    <a href="graph.html">Graph</a>
    <a href="map.html">Map</a>
    <a href="table.html">Table</a>
  </div>
  <hr style="height:3px;border-width:0;color:rgb(148, 96, 96);background-color:gray">

  <table id="table1" cellspacing='0' cellpadding='10'" border='1' , bgcolor='white' border-bottom: 2px solid #ddd;>
    <h1 > Current Data </h1>
   <tr bgcolor='gray' align="right">
     <th align="right" >Real time water level value :-</th>
   </tr>
   <tbody style="font-weight:bold ; width: 100px ; height: 30px;" cellspacing='0' cellpadding='10' align="center" id="tableContent1" ></tbody>
</table>

 <hr style="height:3px;border-width:0;color:rgb(148, 96, 96);background-color:gray">
  <center>
    <h1>Live Water Level Data</h1>
  </center>
  <center>
    <table id="table1" cellspacing='0' cellpadding='10' border='1' , bgcolor='pink' border-bottom: 1px solid #ddd;>
      <tr bgcolor='gray'>
        <th>Time</th>
        <th>Date</th>
        <th>Water level</th>
        <th>City code</th>
        <th>City </th>
        <th>Voltage</th>

      </tr>
      <tbody id="tableContent"></tbody>
      
    </table>
  </center>

  <hr style="height:3px;border-width: 1;color:gray; background-color:gray">
  
  
</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<script>
  $(document).ready(function () {
    refreshTable();
    setInterval(refreshTable, 5000);
  });
   function refreshTable() {
    $.getJSON('https://spreadsheets.google.com/feeds/list/1f1GTmf6-73sgdrKux5DTSbCsI1ObygfWjmUNQIxMqc0/2/public/full?alt=json', function (data) {

      var trHTML = '';
      var latest = '';
      var len = data.feed.entry.length;
      
      for (var i = len-1; i > 0 ; --i)
     {
       var time =  data.feed.entry[i].gsx$time.$t;
       var date = data.feed.entry[i].gsx$date.$t;
       var level = data.feed.entry[i].gsx$level.$t;
       var citycode = data.feed.entry[i].gsx$citycode.$t;
       var latest = data.feed.entry[len-1].gsx$level.$t;
       if( citycode = "1001" ) 
       {
         var city = "nagpur";
       }
       var voltage =  data.feed.entry[i].gsx$voltage.$t ;
       
       trHTML += '<tr bgcolor="#e6f7ff"><th>' + time + '</th><td>' + date +
          '</th><td>' + level + '</td><th>' + citycode + '</th><td>' + city + '</th><td>' + voltage + '</td></tr>';
      }
     console.log(trHTML);
      $('#tableContent').html(trHTML);
      var trHTML = '';

      console.log(latest);
      $('#tableContent1').html(latest);
      var latest = '';


    });
    
  }

</script>
</html>























