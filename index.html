<!DOCTYPE html>
<html>
<head>
    <title>Live Monitoring Of Water</title>
      <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
      <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
    
</head>

<body>
  <div id="column_chart" style="width: 100%; height: 400px;"></div>
  <hr style="height:3px;border-width:0;color:rgb(148, 96, 96);background-color:gray">
    <center><h1>Live Water Level Data</h1></center>
        
   	
   		<center><table id="table1" cellspacing='0' cellpadding='10' border='1', bgcolor='pink'  border-bottom: 1px solid #ddd;>
            <tr bgcolor='gray'>
                <th>Time</th>
                <th>Date</th>
                <th>Value1</th>
                <th>city id</th>
                
            </tr>
            <tbody id="tableContent" ></tbody> 
            </tbody>
        </table></center>

        <hr style="height:3px;border-width:0;color:gray;background-color:gray">

</body>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>

<script>
    /////////////Ajax Requests////////////
    $(document).ready(function() {
        // Fetch the initial table
        refreshTable();
    
        // Fetch every 1 second
        setInterval(refreshTable, 5000);
    });
    
    function refreshTable(){
        
        // var trHTML = '';	    
        
        $.getJSON('https://spreadsheets.google.com/feeds/list/1A9MxTygT3DphZG3AcDuRuGZYUQETZvUvVMOHiMvnzlU/1/public/full?alt=json', function(data) {
        	
            	var trHTML = '';

            	for (var i = 0; i < data.feed.entry.length; ++i) {
                	

                    trHTML += '<tr bgcolor="#e6f7ff" ><th>' + data.feed.entry[i].gsx$date.$t + 
                        	  '</th><td>' + data.feed.entry[i].gsx$time.$t + 
                        	  '</td><th>' + data.feed.entry[i].gsx$value1.$t + 
                            '</th><td>' + data.feed.entry[i].gsx$cityid.$t + 
                        	  '</td></tr>';

                }

                console.log(trHTML);
        		$('#tableContent').html(trHTML);
        		var trHTML = '';
            

        	});	 
    }	
    
</script>


<!DOCTYPE html>
<html>
<head>
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js"></script>
  <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
</head>
<body>
  <div id="column_chart" style="width: 100%; height: 400px;"></div>
</body>
<script type="text/javascript">
  $(document).ready(function() {
    // Fetch the initial Chart
    refreshChart();
    // Fetch every 5 second
    setInterval(refreshChart, 5000);
  });
  google.charts.load("current", {packages:['corechart']});
  google.charts.setOnLoadCallback(refreshChart);

  function refreshChart(){
    var jsonDataObject =[];
    var graph_arr = [['City Id', 'Value1', { role: 'style' }]];
    var bar_color = [];
    $.getJSON('https://spreadsheets.google.com/feeds/list/1A9MxTygT3DphZG3AcDuRuGZYUQETZvUvVMOHiMvnzlU/1/public/full?alt=json', function(data) {
      for (var i = 0; i < 5; ++i) {
        var json_data = {
          "CityId" :data.feed.entry[i].gsx$cityid.$t,
          "Value1": parseFloat(data.feed.entry[i].gsx$value1.$t),
          };
          jsonDataObject.push(json_data);
      };
    
      // Converting Json Object to JavaScript Array
      for(var j in jsonDataObject){
          graph_arr.push([jsonDataObject[j].CityID,jsonDataObject[j].Value1, bar_color[j]]);
      }
      var graphArray_Final = google.visualization.arrayToDataTable(graph_arr);
    
      var data = new google.visualization.DataView(graphArray_Final); 

      var options = {
        title: 'Level Of Water at different location',
        hAxis: { title: 'City Id'},
        vAxis: { title: 'Level of Water'},
        legend: { position: "none" },
      };
      var chart = new google.visualization.ColumnChart(document.getElementById('column_chart'));
      chart.draw(data, options);
    });	 
  }
</script>
</html>







